# Классификация разрядов молний по данным локаторов с машинным обучением.
Фурлетов Никита 2023 г.

## 1. Цель и описание
Данный проект нацелен на улучшение классификации молний по радару.

Цель:
- Превзойти классификацию, основанную на y-параметре.
- Сделать развёрнутый анализ радарной информации для задачи классификации гидрометеоров.

Данные:
Для работы использовались данные с локаторов 26061 - РГГМУ, 26850 - Минск за 2021г. <br />
Данные грозопеленгационной сети - blitzortung

Параметры:
- Отражаемость, высота облачности, явление  <br />

Дополнительно (только для базовой классификации по одной ячейке):
- Радиальная скорость
- Ширина спектра
- Дифференциальная отражаемость
- Дифференциальная фаза

Получилось два решения задачи:
 - Классификация по одной ячейке (1x1) - basic_#####.ipynb
 - Классификация блока (5х5) - block_#####.ipynb
 , где ##### - номер радара.
 
Статья по блочной классификации: https://www.researchgate.net/publication/360419780_Monitoring_Lightning_Location_Based_on_Deep_Learning_Combined_with_Multisource_Spatial_Data


Ограничения:
***Необходимо как минимум 64 гб RAM для анализа от 2 тыс сроков.***

## 2. Структура проекта

### data - Папка с данными 
binary data - Данные радара в бинарном формате. <br />
data_BO - blitzortung грозопеленгационные данные <br />
ASTER - данные DEM (Цифровой модели рельефа, только 26061, не использовались) <br />

***interim - промежуточные и итоговые данные***

Форматы: <br />
.parquet - оптимизированный формат для таблиц pandas.DataFrame <br />
.npy - сохранённый numpy.array 
- df_blitz_#####.parquet - грозопеленгационные данные в таблице.
- stack_#####.npy - Основной файл со всей информацией по одному локатору. Размерность (Срок, Х, Y, параметры(DWR_preprocess.get_stacked_array))
- basic_classif_#####.parquet - данные для базового анализа.
- 

lightning_stack_##### - данные для классификации блока

numpy_data - данные для обучения модели


### docs - текстовые документы
### figures - графики (устаревшие)
### models - модели
### notebooks

- basic_#####.ipynb - Классификация по одной ячейке (1x1), анализ радиолокационной информации, кластеризация
- block_#####.ipynb - Классификация блока (5х5)
- EDA.ipynb - Исследовательский Анализ Данных, черновик
- data_eng.ipynb - черновик для обработки данных
- Lightning classification via radar data main - основной
- regression - попытка прогнозировать количество разрядов в ячейке
- old_notebooks - устаревште ноутбуки, могут быть полезны

***DWR_preprocess.py*** - "библиотека" для данного проекта

requirements.txt - зависимости <br />
lightning-env.txt - conda environment <br />
github - версии
